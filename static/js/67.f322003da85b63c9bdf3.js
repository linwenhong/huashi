webpackJsonp([67],{"5FEr":function(t,s){},fWO4:function(t,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=a("BHhu"),e=a("8IWg"),n=a("+0rj"),o=a("TNi3"),l=a("BXxX"),r={name:"noticeDetails",data:function(){return{id:this.$route.params.id,type:this.$route.query.type,readonly:this.$route.query.readonly,dataKeys:e.g,form:{},canSubmit:!0,html:"",imgUrl:"",annexUrl:"",count:0}},methods:{download:function(){var t={};t.$form=$('<form method="GET" id="form"></form>'),t.$form.attr("action",i.a+this.form.annex),t.$form.appendTo($("body")),t.$form.submit(),this.count++},fileChange:function(t){var s=this;if(t)$("#file").get(0).files[0]&&(this.form.annex=$("#file").get(0).files[0],this.annexUrl=this.form.annex.name,this.count++);else if($("#showImg").get(0).files[0]){this.form.pic=$("#showImg").get(0).files[0];var a=new FileReader;a.readAsDataURL($("#showImg").get(0).files[0]),a.onload=function(t){s.imgUrl=t.target.result},this.count++}},edit:function(){$("#eg").addClass("no-padding"),$(".click2edit").summernote({lang:"zh-CN",focus:!0})},save:function(){var t=this;if(this.canSubmit)if(this.form.name){this.canSubmit=!1,$("#eg").removeClass("no-padding"),$(".click2edit").destroy();var s={type:this.type,detail:$(".click2edit").code(),name:this.form.name,key:this.form.key,pic:this.form.pic,annex:this.form.annex};this.form.type=this.type,this.form.detail=$(".click2edit").code(),n.a.getFormVal(this.dataKeys,s).then(function(s){return t.confirm(s)})}else toastr.warning("请填写标题")},confirm:function(t){var s=this;"new"!=this.id?l.a.Notice.edit(this.id,t).then(function(t){return s.responseHandle(t)}):l.a.Notice.add(t).then(function(t){return s.responseHandle(t)})},responseHandle:function(t){200==t.code?(toastr.success(t.msg),this.canSubmit=!0,setTimeout(function(){return n.a.tabReload(501)},1e3)):(toastr.error(t.msg),this.canSubmit=!0)},cancel:function(){o.a.closeNowTab()}},created:function(){var t=this;"new"!=this.id&&l.a.Notice.details(this.id).then(function(s){200==s.code&&(t.form=s.data,t.html=t.form.detail,s.data.pic&&(t.imgUrl=i.a+s.data.pic))})},mounted:function(){}},c={render:function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"wrapper wrapper-content"},[a("div",{staticClass:"ibox float-e-margins"},[t._m(0),t._v(" "),a("div",{staticClass:"ibox-content"},[a("form",{staticClass:"form-horizontal",on:{submit:function(s){return s.preventDefault(),t.save(s)}}},[a("div",{staticClass:"row"},[t.readonly?[a("label",{staticClass:"col-sm-2 control-label"}),t._v(" "),a("div",{staticClass:"col-sm-10"},[a("h1",{},[t._v(t._s(t.form.name))]),t._v(" "),a("h6",[t._v(t._s(t.form.created_at))])]),t._v(" "),t.form.annex?a("div",{staticClass:"form-group"},[a("label",{staticClass:"col-sm-2 control-label"},[t._v("附件")]),t._v(" "),a("div",{staticClass:"col-sm-4"},[t._m(4),t._v(" "),a("input",{staticClass:"file",attrs:{id:"download"},on:{click:function(s){t.download()}}})])]):t._e()]:[a("div",{staticClass:"form-group"},[t._m(1),t._v(" "),a("div",{staticClass:"col-sm-4"},[t.readonly?t._e():a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.form.name},on:{input:function(s){s.target.composing||t.$set(t.form,"name",s.target.value)}}}),t._v(" "),t.readonly?a("p",[t._v(t._s(t.form.name))]):t._e()])]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"col-sm-2 control-label"},[t._v("展示图片")]),t._v(" "),a("div",{staticClass:"col-sm-4"},[t._m(2),t._v(" "),a("input",{staticClass:"file",attrs:{id:"showImg",type:"file"},on:{change:function(s){t.fileChange()}}}),t._v("\n                (首页轮播展示图,查看不展示)\n              ")])]),t._v(" "),a("div",{staticClass:"form-group"},[a("div",{staticClass:"col-sm-2"}),t._v(" "),a("div",{staticClass:"col-sm-4"},[a("img",{staticClass:"showImg",attrs:{src:t.imgUrl}})])]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"col-sm-2 control-label"},[t._v("附件")]),t._v(" "),a("div",{staticClass:"col-sm-4"},[t._m(3),t._v(" "),a("input",{staticClass:"file",attrs:{id:"file",type:"file"},on:{change:function(s){t.fileChange(1)}}}),t._v("\n                "+t._s(t.annexUrl)+"\n              ")])])],t._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"col-sm-2 control-label"},["new"==t.id?[t._v("正文")]:t._e()],2),t._v(" "),a("div",{staticClass:"col-sm-10"},[a("div",{attrs:{id:"eg"}},[a("div",{staticClass:"click2edit wrapper",domProps:{innerHTML:t._s(t.form.detail)}})])])])],2)]),t._v(" "),a("div",{staticClass:"text-center btns"},[t.readonly?t._e():[a("button",{staticClass:"btn btn-info",on:{click:function(s){t.edit()}}},[t._v("编辑正文HTML")]),t._v(" "),t.canSubmit?a("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(s){t.save()}}},[t._v("保存")]):t._e(),t._v(" "),t.canSubmit?t._e():a("button",{staticClass:"btn btn-default"},[t._v("保存")])],t._v(" "),a("b",{staticClass:"btn btn-white",on:{click:t.cancel}},[t._v("取消")])],2)])]),t._v(" "),a("div",{staticStyle:{display:"none"}},[t._v(t._s(t.count))])])},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"ibox-title"},[s("h5",[this._v("公告详情")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("label",{staticClass:"col-sm-2 control-label"},[s("span",{staticClass:"MustFill"},[this._v("*")]),this._v("标题")])},function(){var t=this.$createElement,s=this._self._c||t;return s("button",{staticClass:"btn btn-sm btn-primary",attrs:{type:"button"}},[s("i",{staticClass:"fa fa-upload"}),this._v("  \n                  "),s("span",{staticClass:"bold"},[this._v("选择图片")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("button",{staticClass:"btn btn-sm btn-primary",attrs:{type:"button"}},[s("i",{staticClass:"fa fa-upload"}),this._v("  \n                  "),s("span",{staticClass:"bold"},[this._v("选择文件")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("button",{staticClass:"btn btn-sm btn-primary",attrs:{type:"button"}},[s("i",{staticClass:"fa fa-download"}),this._v("  \n                  "),s("span",{staticClass:"bold"},[this._v("下载附件")])])}]};var m=a("VU/8")(r,c,!1,function(t){a("5FEr")},"data-v-3271e95c",null);s.default=m.exports}});
//# sourceMappingURL=67.f322003da85b63c9bdf3.js.map