webpackJsonp([93],{Dgiq:function(t,e){},OPg9:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("9+VK"),n=s("TNi3"),i=s("jNku"),o=s("+0rj"),r=s("BXxX"),l={name:"User",data:function(){return{items:[],roles:[],selectRole:null,total:0,page:1,size:10,status:-1,user:a.a.getUser(),operation:{}}},methods:{search:function(){this.getDataTables()},pageChange:function(t){this.getDataTables(t)},getDataTables:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,s={page:e};this.status>-1&&(s.status=this.status),r.a.Users.get(s).then(function(s){200==s.code&&(t.page=e,t.items=s.data.data,t.total=s.data.total,setTimeout(function(){return i.a.iCheck()},200))})},add:function(){n.a.addDetailsTab("/views/user/new","用户-新增")},edit:function(t){n.a.addDetailsTab("/views/user/"+t.id,"用户-编辑")},editPassword:function(t){n.a.addDetailsTab("/editUserPassword/"+t.id,"修改密码-"+t.name)},check:function(t){var e=this;swal({title:"确定审核通过吗？",text:"确定后用户将可以登录系统，请谨慎操作！",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确定",cancelButtonText:"取消",closeOnConfirm:!1},function(){r.a.Users.edit(t.id,{type:"status",status:2}).then(function(t){200==t.code?(swal("审核成功！","该用户已经正常启用","success"),e.getDataTables(e.page)):toastr.error(t.msg)})})},delConfirm:function(t){var e=this;r.a.Users.del(t.id).then(function(t){200==t.code&&e.getDataTables()})},selectUsers:function(){0!=o.a.getChecked("select").length?(this.selectRole=null,$("#Modal").modal("show")):toastr.warning("请勾选用户")},submit:function(){this.selectRole?r.a.UpdateUsersRoles({r_id:this.selectRole,ids:o.a.getChecked("select")}).then(function(t){200==t.code?(toastr.success("修改成功"),$("#Modal").modal("hide")):toastr.error(t.msg)}):toastr.warning("请选择分组")}},created:function(){var t=this;a.a.hasPermission("post_user")&&(this.operation.add=!0),a.a.hasPermission("update_user")&&(this.operation.edit=!0),a.a.hasPermission("delete_user")&&(this.operation.del=!0),r.a.Roles.get().then(function(e){200==e.code&&(t.roles=e.data,console.log(t.roles))}),this.getDataTables()},mounted:function(){}},c={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"wrapper wrapper-content"},[s("div",{staticClass:"ibox float-e-margins"},[t._m(0),t._v(" "),s("div",{staticClass:"ibox-content"},[s("div",{staticClass:"row"},[s("div",{staticClass:"searchOption"},[s("label",{staticClass:"control-label"},[t._v("用户状态")]),t._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.status,expression:"status"}],staticClass:"form-control",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.status=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"-1"}},[t._v("全部")]),t._v(" "),s("option",{attrs:{value:"1"}},[t._v("未审核")]),t._v(" "),s("option",{attrs:{value:"2"}},[t._v("正常")])])]),t._v(" "),s("button",{staticClass:"btn btn-warning search",attrs:{type:"button"},on:{click:t.search}},[t._v("查询")])]),t._v(" "),t.operation.add?s("div",{staticClass:"text-left"},[s("button",{staticClass:"btn btn-primary",on:{click:function(e){t.add()}}},[t._v("新增")]),t._v(" "),t.operation.edit?s("button",{staticClass:"btn btn-warning",on:{click:function(e){t.selectUsers()}}},[t._v("勾选用户分组")]):t._e()]):t._e(),t._v(" "),s("table",{staticClass:"table table-bordered text-center"},[t._m(1),t._v(" "),s("tbody",t._l(t.items,function(e,a){return s("tr",{key:e.id},[s("td",[s("div",{staticClass:"checkbox i-checks"},[s("label",[s("input",{attrs:{name:"select",type:"checkbox"},domProps:{value:e.id}}),t._v(" "),s("i")])])]),t._v(" "),s("td",[t._v(t._s(a+1))]),t._v(" "),s("td",[t._v(t._s(e.name))]),t._v(" "),s("td",[t._v(t._s(e.username))]),t._v(" "),s("td",[t._v(t._s(e.phone))]),t._v(" "),s("td",[t._v(t._s(e.created_at))]),t._v(" "),s("td",["admin"!=e.username?[t.operation.edit&&1==e.status?s("button",{staticClass:"btn btn-sm btn-warning",attrs:{type:"button"},on:{click:function(s){t.check(e)}}},[t._v("审核通过")]):t._e(),t._v(" "),t.operation.edit?s("button",{staticClass:"btn btn-sm btn-primary",attrs:{type:"button"},on:{click:function(s){t.edit(e)}}},[t._v("编辑")]):t._e(),t._v(" "),t.operation.edit?s("button",{staticClass:"btn btn-sm btn-danger",attrs:{type:"button"},on:{click:function(s){t.editPassword(e)}}},[t._v("修改密码")]):t._e(),t._v(" "),t.operation.del&&t.user.id!=e.id?s("delete",{attrs:{item:e},on:{delConfirm:t.delConfirm}}):t._e()]:["admin"==t.user.username&&1==t.user.id?s("button",{staticClass:"btn btn-sm btn-primary",attrs:{type:"button"},on:{click:function(s){t.edit(e)}}},[t._v("编辑")]):t._e()]],2)])}))]),t._v(" "),s("vue-pagination",{attrs:{"current-page":t.page,total:t.total,"page-size":t.size,theme:"gray"},on:{"current-change":t.pageChange}})],1)]),t._v(" "),s("div",{staticClass:"modal inmodal fade",attrs:{id:"Modal",tabindex:"-1",role:"dialog","aria-hidden":"true"}},[s("div",{staticClass:"modal-dialog modal-md"},[s("div",{staticClass:"modal-content"},[t._m(2),t._v(" "),s("form",{staticClass:"form-horizontal",attrs:{id:"form"},on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[s("div",{staticClass:"modal-body"},[s("div",{staticClass:"row"},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"col-sm-3 control-label"},[t._v("用户组")]),t._v(" "),s("div",{staticClass:"col-sm-8"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.selectRole,expression:"selectRole"}],staticClass:"form-control",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.selectRole=e.target.multiple?s:s[0]}}},t._l(t.roles,function(e){return s("option",{domProps:{value:e.id}},[t._v(t._s(e.name))])}))])])])]),t._v(" "),t._m(3)])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ibox-title"},[e("h5",[this._v("用户管理")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th"),t._v(" "),s("th",[t._v("编号")]),t._v(" "),s("th",[t._v("真实姓名")]),t._v(" "),s("th",[t._v("用户名")]),t._v(" "),s("th",[t._v("联系电话")]),t._v(" "),s("th",[t._v("创建时间")]),t._v(" "),s("th",[t._v("操作")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-header"},[e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[e("span",{attrs:{"aria-hidden":"true"}},[this._v("×")]),e("span",{staticClass:"sr-only"},[this._v("Close")])]),this._v(" "),e("h4",{staticClass:"modal-title"},[this._v("为勾选用户选择分组")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-footer"},[e("b",{staticClass:"btn btn-white",attrs:{"data-dismiss":"modal"}},[this._v("关闭")]),this._v(" "),e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[this._v("提交")])])}]};var d=s("VU/8")(l,c,!1,function(t){s("Dgiq")},"data-v-035ea1d8",null);e.default=d.exports}});
//# sourceMappingURL=93.efaeb27b8d0e6e59ef49.js.map